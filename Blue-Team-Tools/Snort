ğŸ§  Vad Ã¤r Snort?
Snort Ã¤r ett intrÃ¥ngsdetekteringssystem (IDS) och intrÃ¥ngsskyddssystem (IPS) utvecklat av Cisco.
Det anvÃ¤nds fÃ¶r att Ã¶vervaka nÃ¤tverkstrafik i realtid och identifiera misstÃ¤nkt aktivitet baserat pÃ¥ fÃ¶rdefinierade regler.

Du kan anvÃ¤nda Snort i tre huvudsakliga lÃ¤gen:
  1. Sniffer Mode â€“ visar alla paket som passerar nÃ¤tverksgrÃ¤nssnittet.
  2. Packet Logger Mode â€“ loggar trafiken till filer fÃ¶r senare analys.
  3. Network Intrusion Detection Mode (NIDS) â€“ analyserar trafiken och jÃ¤mfÃ¶r den mot ett regelsystem fÃ¶r att upptÃ¤cka attacker eller avvikande beteende.

âš™ï¸ Hur Snort fungerar
Snort fungerar genom att:
  1. FÃ¥nga upp nÃ¤tverkspaket (via libpcap, samma som Wireshark anvÃ¤nder).
  2. Analysera innehÃ¥llet i paketen.
  3. Matcha dessa mot en databas av signaturer (regler) fÃ¶r kÃ¤nda attacker.
  4. Generera varningar eller blockera trafik beroende pÃ¥ konfigurationen.

ğŸ“œ Exempel pÃ¥ Snort-regler
Snort-regler Ã¤r hjÃ¤rtat i systemet.
En regel bestÃ¥r av tvÃ¥ delar:
  - Header â†’ anger typ av trafik som ska Ã¶vervakas.
  - Options â†’ beskriver vad som ska matchas och vilken Ã¥tgÃ¤rd som ska tas.

ğŸ§© Exempel 1: Enkel ICMP-regel (ping)
  alert icmp any any -> any any (msg:"Ping request detected"; sid:1000001; rev:1;)
    ğŸ‘‰ FÃ¶rklaring:
          alert = Ã¥tgÃ¤rden (generera varning).
          icmp any any -> any any = gÃ¤ller all ICMP-trafik (t.ex. ping).
          msg = text som visas i loggen.
          sid = unikt ID fÃ¶r regeln.

ğŸ§© Exempel 2: HTTP-regel fÃ¶r att upptÃ¤cka ordet "password"
  alert tcp any any -> any 80 (msg:"Password keyword detected"; content:"password"; nocase; sid:1000002; rev:1;)
    ğŸ‘‰ FÃ¶rklaring:
        Ã–vervakar TCP-trafik till port 80 (HTTP).
        Letar efter strÃ¤ngen "password" i innehÃ¥llet.
        nocase = oberoende av versaler/gemener.

ğŸ§© Exempel 3: Blockera fÃ¶rsÃ¶k att logga in via Telnet
  drop tcp any any -> any 23 (msg:"Telnet connection attempt blocked"; sid:1000003; rev:1;)
    ğŸ‘‰ FÃ¶rklaring:
        drop = stoppar paketet (om Snort kÃ¶rs som IPS).
        port 23 = Telnet (osÃ¤kert protokoll).

ğŸ§¾ Exempel pÃ¥ kÃ¶rning
FÃ¶r att starta Snort i snifferlÃ¤ge:
  sudo snort -v -l .

FÃ¶r att kÃ¶ra i IDS-lÃ¤ge med regler:
  sudo snort -A console -c /etc/snort/snort.conf -i eth0

    -A console = skriv ut varningar till terminalen.
    -c = anger konfigurationsfil.
    -i eth0 = anger vilket nÃ¤tverksinterface som ska Ã¶vervakas.

