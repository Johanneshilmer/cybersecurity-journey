Sound the alarm: Detection and response
Module 1

The 5 W's of an incident
  Who triggered the incident
  What happened
  When the incident took place
  Where the incident tooke place
  Why the incident occurred


NIST Incident Response Lifecycle
  FÃ¶r hur organisationer bÃ¶r hantera IT-incidenter, sÃ¤rskilt inom cybersÃ¤kerhet. Den bestÃ¥r av fyra steg som tillsammans bildar en cyklisk process:
  Innefattar 4 olika steg
    1. Preparation (FÃ¶rbered)
      ğŸ‘‰Utveckla policies och rutiner fÃ¶r incidenthantering.
      ğŸ‘‰TrÃ¤na personalen och skapa incident response team (IRT).
      ğŸ‘‰FÃ¶rbereda verktyg, loggning, Ã¶vervakning och system fÃ¶r att kunna upptÃ¤cka incidenter.
      ğŸ‘‰SÃ¤kerstÃ¤lla att det finns kommunikationsplaner (vem kontaktas och hur).
      Syftet: Att organisationen ska vara redo att agera snabbt och effektivt nÃ¤r en incident intrÃ¤ffar.
    2. Detection and analysis (UpptÃ¤ck och analysera.)
      ğŸ‘‰UpptÃ¤cka avvikande beteenden via loggar, SIEM, IDS/IPS, antivirus, anvÃ¤ndarrapporter osv.
      ğŸ‘‰Analysera indikatorer pÃ¥ kompromettering (IOCs).
      ğŸ‘‰AvgÃ¶ra om det faktiskt Ã¤r en sÃ¤kerhetsincident, vilken typ och hur allvarlig den Ã¤r.
      ğŸ‘‰Dokumentera hÃ¤ndelsen.
      Syftet: Att snabbt upptÃ¤cka och fÃ¶rstÃ¥ incidentens omfattning fÃ¶r att kunna agera rÃ¤tt.
    3. Containment, Eradication and Recovery (BegrÃ¤nsa, rensa och Ã¥terstÃ¤ll.)
      ğŸ‘‰Containment: BegrÃ¤nsa skadan och stoppa spridning (t.ex. isolera nÃ¤tverk, blockera konton).
      ğŸ‘‰Eradication: Ta bort sjÃ¤lva orsaken (t.ex. rensa malware, patcha sÃ¥rbarheter, stÃ¤nga bakdÃ¶rrar).
      ğŸ‘‰Recovery: Ã…terstÃ¤lla system till normal drift, kontrollera att hotet Ã¤r borta och att det inte finns risk fÃ¶r Ã¥terinfektion.
      Syftet: Att minimera skada, Ã¥terstÃ¤lla verksamheten och eliminera hotet.
    4. Post-Incident activity (LÃ¤r dig av incidenten.)
      ğŸ‘‰UtvÃ¤rdera vad som gick bra och vad som kan fÃ¶rbÃ¤ttras.
      ğŸ‘‰Dokumentera incidenten och lÃ¤rdomar.
      ğŸ‘‰Uppdatera policies, rutiner, och utbildningar.
      ğŸ‘‰Dela erfarenheter med relevanta parter (internt och ibland externt).
      Syftet: Att bli bÃ¤ttre fÃ¶rberedd infÃ¶r nÃ¤sta incident och minska risken fÃ¶r upprepning.


CSIRT (Computer security incident response teams)
  Ã„r ett specialiserat team inom en organisaton som ansvarar fÃ¶r att hantera och svara pÃ¥ IT-sÃ¤kerhetsincidenter
  Olika roller:
    Security analyst â€“ Ã¶vervakar system, analyserar och eskalerar hot.
    Technical lead â€“ hanterar tekniska Ã¥tgÃ¤rder som patchning, containment och recovery.
    Incident coordinator â€“ koordinerar med andra avdelningar (HR, juridik, PR, IT, m.fl.).
  Huvuduppgifter fÃ¶r ett CSIRT:
    1. Incidenthantering â€“ ta emot rapporter, analysera incidenter, och koordinera responsen.
    2. Kommunikation â€“ fungera som central kontaktpunkt fÃ¶r incidentrapportering, bÃ¥de internt (anstÃ¤llda, IT-avdelning) och externt (andra organisationer, myndigheter).
    3. Samordning â€“ koordinera arbetet mellan olika tekniska och organisatoriska grupper vid incidenter.
    4. FÃ¶rebyggande arbete â€“ analysera hotbilder, sprida information om sÃ¥rbarheter, och fÃ¶reslÃ¥ fÃ¶rbÃ¤ttringar av sÃ¤kerhetsrutiner.
    5. KunskapsÃ¶verfÃ¶ring â€“ utbilda personal och Ã¶ka medvetenheten om IT-sÃ¤kerhet.

SOC (Security Operations Center)
  Ett SOC Ã¤r en organisatorisk enhet (ofta separat, men ibland inom CSIRT) som ansvarar fÃ¶r Ã¶vervakning, analys och respons pÃ¥ hot.
  Struktur och roller:
    Tier 1 SOC Analyst (L1) â€“ minst erfarna, Ã¶vervakar, prioriterar och eskalerar larm.
    Tier 2 SOC Analyst (L2) â€“ mer erfarna, gÃ¶r djupare undersÃ¶kningar och justerar sÃ¤kerhetsverktyg.
    Tier 3 SOC Lead (L3) â€“ avancerade experter, leder teamet och utfÃ¶r avancerad analys (t.ex. forensik, malware-analys).
    SOC Manager â€“ leder hela SOC, ansvarar fÃ¶r rekrytering, rapportering och kommunikation med ledningen.
  Specialistroller i SOC:
    Forensic investigators â€“ samlar och analyserar digitala bevis.
    Threat hunters â€“ sÃ¶ker efter avancerade hot och nya attackmetoder.

ğŸ‘‰ Kort sagt:
  CSIRT Ã¤r incidentresponsteamet som samordnar insatser nÃ¤r nÃ¥got hÃ¤nder.
  SOC Ã¤r Ã¶vervaknings- och analysenheten som kontinuerligt letar efter hot och hanterar incidenter i realtid.


Incident response tools

  Typer av dokumentation
    ğŸ‘‰Playbooks
      En manual som ger information om Ã¥tgÃ¤rder fÃ¶r olika actions.
        Dokumentation tools: Google Docs, OneNote, Evernote, Notepad++
        Ticketing system: Jira
    ğŸ‘‰Incident handler's journals
    ğŸ‘‰Ploicies
    ğŸ‘‰Plans
    ğŸ‘‰Final reports

  Intrusion detection system (IDS)
    System som Ã¶vervakar system / network aktivitet och utger alerts pÃ¥ mÃ¶jliga intrÃ¥ng.
  Intrusion prevention system (IPS)
    System som Ã¶vervakar system / network aktivitet och sedan gÃ¶r "action" fÃ¶r att stoppa mÃ¶jliga intrÃ¥ng.
  IDS/IPS tools
    ğŸ‘‰Snort
    ğŸ‘‰Zeek
    ğŸ‘‰Kismet
    ğŸ‘‰Sagan
    ğŸ‘‰Suricata
  Endpoint Detection and Response (EDR)
    Till skillnad frÃ¥n IDS/IPS sÃ¥ kan EDR analysera och svara pÃ¥ hot med hjÃ¤lp av beteendeanalys, AI och automatisering. Detta gÃ¶r de sjÃ¤lv.
    Open EDR
    Bitdefender
    FortiEDR

ğŸ‘‰ Kort sagt: IDS upptÃ¤cker, IPS upptÃ¤cker och stoppar, medan EDR ger mer avancerad analys och automatiserade svar pÃ¥ hot direkt pÃ¥ enheterna.

Dessutom finns fyra centrala detektionskategorier:
  True positive: RÃ¤tt identifierat hot.
  True negative: Inget hot och ingen varning.
  False positive: Falsk varning, inget verkligt hot.
  False negative: Missat hot, farligt eftersom attacken fÃ¶rblir oupptÃ¤ckt.


Security Information and Event Management (SIEM)
  Ã„r verktyg som samlar in, lagrar och analyserar loggdata fÃ¶r att upptÃ¤cka, undersÃ¶ka och hantera sÃ¤kerhetsincidenter.
  FÃ¶rdelar med SIEM:
    - Ger tillgÃ¥ng till hÃ¤ndelsedata i realtid frÃ¥n mÃ¥nga olika system och enheter.
    - Ã–vervakar, upptÃ¤cker och skickar varningar vid misstÃ¤nkt aktivitet.
    - Lagrar loggar fÃ¶r bÃ¥de historisk analys och krav pÃ¥ datalagring.

  SIEM-processen bestÃ¥r av tre steg:
    1. Insamling och aggregering â€“ loggar frÃ¥n t.ex. brandvÃ¤ggar, servrar och routrar samlas i en central plats. Data parsas fÃ¶r att bli mer lÃ¤sbar.
    2. Normalisering â€“ data omvandlas till ett standardiserat, strukturerat format fÃ¶r att kunna bearbetas och sÃ¶kas effektivt.
    3. Analys â€“ med hjÃ¤lp av regler, villkor och korrelation mellan hÃ¤ndelser identifieras mÃ¶nster som tyder pÃ¥ hot, vilket genererar varningar.

Exempel pÃ¥ SIEM-verktyg: AlienVault OSSIM, Chronicle, Elastic, Exabeam, IBM QRadar, LogRhythm och Splunk.

ğŸ‘‰ Kort sagt: SIEM centraliserar och strukturerar loggdata frÃ¥n mÃ¥nga kÃ¤llor fÃ¶r att ge sÃ¤kerhetsteam mÃ¶jlighet att effektivt upptÃ¤cka, analysera och hantera potentiella hot.

Exempel pÃ¥ en logg:
  ğŸ‘‰April 3 11:01:21 server sshd[1088]: Failed password for user nuhara from 218.124.14.105 port 5023
      host = server
      process = sshd
      source_user = nuhara
      source ip = 218.124.14.105
      source port = 5023

Security Orchestration, Automation, and Response (SOAR)
  Samling av applikationer och vÃ¤rktyg samt workflows som anvÃ¤nder automation till att aggera mot sÃ¤kerhets event.








Module 2
Network monitoring and analysis

Indicators of compromise (IOC)
  Observerbara bevis som tyder pÃ¥ tecken pÃ¥ en potentiell sÃ¤kerhetsincident.
  Data exfiltration: ObehÃ¶rig Ã¶verfÃ¶ring av data frÃ¥n ett system till ett annat sÃ¥ som username, password som attackerare gÃ¶r.

NÃ¤tverksÃ¶vervakning Ã¤r avgÃ¶rande fÃ¶r att upptÃ¤cka avvikelser och misstÃ¤nkt aktivitet i nÃ¤tverkstrafiken. 
Genom att samla in och analysera data frÃ¥n nÃ¤tverkskommunikation kan sÃ¤kerhetsteam skapa en baseline (normal beteendenivÃ¥) och jÃ¤mfÃ¶ra mot den fÃ¶r att identifiera avvikelser.

Metoder fÃ¶r nÃ¤tverksÃ¶vervakning:
  FlÃ¶desanalys: undersÃ¶ker protokoll, portar och paketflÃ¶den. Avvikelser, som felaktiga port-protokoll-kombinationer, kan indikera attacker (t.ex. C2-kommunikation).
  PaketinnehÃ¥ll (payload): analyserar datan i nÃ¤tverkspaketen, ofta fÃ¶r att hitta misstÃ¤nkt trafik som kan tyda pÃ¥ datalÃ¤ckage.
  TidsmÃ¶nster: avvikelser i nÃ¤r trafiken sker (t.ex. stora datamÃ¤ngder utanfÃ¶r normala arbetstider) kan signalera intrÃ¥ng.

Skydd och roller:
  SOC (Security Operations Center): fokuserar pÃ¥ sÃ¤kerhet, upptÃ¤ckt och respons pÃ¥ hot.
  NOC (Network Operations Center): fokuserar pÃ¥ nÃ¤tverkets prestanda, tillgÃ¤nglighet och driftstÃ¶rningar.

Verktyg fÃ¶r nÃ¤tverksÃ¶vervakning:
  IDS (Intrusion Detection Systems): Ã¶vervakar och varnar vid intrÃ¥ngsfÃ¶rsÃ¶k.
  Protokollanalysatorer / Packet sniffers (t.ex. Wireshark, tcpdump): fÃ¥ngar och analyserar nÃ¤tverkstrafik i detalj.

ğŸ‘‰ Kort sagt: Genom att kÃ¤nna sitt nÃ¤tverk, faststÃ¤lla en baseline och anvÃ¤nda Ã¶vervakningsverktyg kan organisationer snabbt upptÃ¤cka intrÃ¥ng och skydda sina system.









