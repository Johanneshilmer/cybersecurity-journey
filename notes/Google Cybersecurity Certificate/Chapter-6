Sound the alarm: Detection and response
Module 1

The 5 W's of an incident
  Who triggered the incident
  What happened
  When the incident took place
  Where the incident tooke place
  Why the incident occurred


NIST Incident Response Lifecycle
  F√∂r hur organisationer b√∂r hantera IT-incidenter, s√§rskilt inom cybers√§kerhet. Den best√•r av fyra steg som tillsammans bildar en cyklisk process:
  Innefattar 4 olika steg
    1. Preparation (F√∂rbered)
      üëâUtveckla policies och rutiner f√∂r incidenthantering.
      üëâTr√§na personalen och skapa incident response team (IRT).
      üëâF√∂rbereda verktyg, loggning, √∂vervakning och system f√∂r att kunna uppt√§cka incidenter.
      üëâS√§kerst√§lla att det finns kommunikationsplaner (vem kontaktas och hur).
      Syftet: Att organisationen ska vara redo att agera snabbt och effektivt n√§r en incident intr√§ffar.
    2. Detection and analysis (Uppt√§ck och analysera.)
      üëâUppt√§cka avvikande beteenden via loggar, SIEM, IDS/IPS, antivirus, anv√§ndarrapporter osv.
      üëâAnalysera indikatorer p√• kompromettering (IOCs).
      üëâAvg√∂ra om det faktiskt √§r en s√§kerhetsincident, vilken typ och hur allvarlig den √§r.
      üëâDokumentera h√§ndelsen.
      Syftet: Att snabbt uppt√§cka och f√∂rst√• incidentens omfattning f√∂r att kunna agera r√§tt.
    3. Containment, Eradication and Recovery (Begr√§nsa, rensa och √•terst√§ll.)
      üëâContainment: Begr√§nsa skadan och stoppa spridning (t.ex. isolera n√§tverk, blockera konton).
      üëâEradication: Ta bort sj√§lva orsaken (t.ex. rensa malware, patcha s√•rbarheter, st√§nga bakd√∂rrar).
      üëâRecovery: √Öterst√§lla system till normal drift, kontrollera att hotet √§r borta och att det inte finns risk f√∂r √•terinfektion.
      Syftet: Att minimera skada, √•terst√§lla verksamheten och eliminera hotet.
    4. Post-Incident activity (L√§r dig av incidenten.)
      üëâUtv√§rdera vad som gick bra och vad som kan f√∂rb√§ttras.
      üëâDokumentera incidenten och l√§rdomar.
      üëâUppdatera policies, rutiner, och utbildningar.
      üëâDela erfarenheter med relevanta parter (internt och ibland externt).
      Syftet: Att bli b√§ttre f√∂rberedd inf√∂r n√§sta incident och minska risken f√∂r upprepning.


CSIRT (Computer security incident response teams)
  √Ñr ett specialiserat team inom en organisaton som ansvarar f√∂r att hantera och svara p√• IT-s√§kerhetsincidenter
  Olika roller:
    Security analyst ‚Äì √∂vervakar system, analyserar och eskalerar hot.
    Technical lead ‚Äì hanterar tekniska √•tg√§rder som patchning, containment och recovery.
    Incident coordinator ‚Äì koordinerar med andra avdelningar (HR, juridik, PR, IT, m.fl.).
  Huvuduppgifter f√∂r ett CSIRT:
    1. Incidenthantering ‚Äì ta emot rapporter, analysera incidenter, och koordinera responsen.
    2. Kommunikation ‚Äì fungera som central kontaktpunkt f√∂r incidentrapportering, b√•de internt (anst√§llda, IT-avdelning) och externt (andra organisationer, myndigheter).
    3. Samordning ‚Äì koordinera arbetet mellan olika tekniska och organisatoriska grupper vid incidenter.
    4. F√∂rebyggande arbete ‚Äì analysera hotbilder, sprida information om s√•rbarheter, och f√∂resl√• f√∂rb√§ttringar av s√§kerhetsrutiner.
    5. Kunskaps√∂verf√∂ring ‚Äì utbilda personal och √∂ka medvetenheten om IT-s√§kerhet.

SOC (Security Operations Center)
  Ett SOC √§r en organisatorisk enhet (ofta separat, men ibland inom CSIRT) som ansvarar f√∂r √∂vervakning, analys och respons p√• hot.
  Struktur och roller:
    Tier 1 SOC Analyst (L1) ‚Äì minst erfarna, √∂vervakar, prioriterar och eskalerar larm.
    Tier 2 SOC Analyst (L2) ‚Äì mer erfarna, g√∂r djupare unders√∂kningar och justerar s√§kerhetsverktyg.
    Tier 3 SOC Lead (L3) ‚Äì avancerade experter, leder teamet och utf√∂r avancerad analys (t.ex. forensik, malware-analys).
    SOC Manager ‚Äì leder hela SOC, ansvarar f√∂r rekrytering, rapportering och kommunikation med ledningen.
  Specialistroller i SOC:
    Forensic investigators ‚Äì samlar och analyserar digitala bevis.
    Threat hunters ‚Äì s√∂ker efter avancerade hot och nya attackmetoder.

üëâ Kort sagt:
  CSIRT √§r incidentresponsteamet som samordnar insatser n√§r n√•got h√§nder.
  SOC √§r √∂vervaknings- och analysenheten som kontinuerligt letar efter hot och hanterar incidenter i realtid.


Incident response tools

  Typer av dokumentation
    üëâPlaybooks
      En manual som ger information om √•tg√§rder f√∂r olika actions.
        Dokumentation tools: Google Docs, OneNote, Evernote, Notepad++
        Ticketing system: Jira
    üëâIncident handler's journals
    üëâPloicies
    üëâPlans
    üëâFinal reports

  Intrusion detection system (IDS)
    System som √∂vervakar system / network aktivitet och utger alerts p√• m√∂jliga intr√•ng.
  Intrusion prevention system (IPS)
    System som √∂vervakar system / network aktivitet och sedan g√∂r "action" f√∂r att stoppa m√∂jliga intr√•ng.
  IDS/IPS tools
    üëâSnort
    üëâZeek
    üëâKismet
    üëâSagan
    üëâSuricata
  Endpoint Detection and Response (EDR)
    Till skillnad fr√•n IDS/IPS s√• kan EDR analysera och svara p√• hot med hj√§lp av beteendeanalys, AI och automatisering. Detta g√∂r de sj√§lv.
    Open EDR
    Bitdefender
    FortiEDR

üëâ Kort sagt: IDS uppt√§cker, IPS uppt√§cker och stoppar, medan EDR ger mer avancerad analys och automatiserade svar p√• hot direkt p√• enheterna.

Dessutom finns fyra centrala detektionskategorier:
  True positive: R√§tt identifierat hot.
  True negative: Inget hot och ingen varning.
  False positive: Falsk varning, inget verkligt hot.
  False negative: Missat hot, farligt eftersom attacken f√∂rblir ouppt√§ckt.


Security Information and Event Management (SIEM)
  √Ñr verktyg som samlar in, lagrar och analyserar loggdata f√∂r att uppt√§cka, unders√∂ka och hantera s√§kerhetsincidenter.
  F√∂rdelar med SIEM:
    - Ger tillg√•ng till h√§ndelsedata i realtid fr√•n m√•nga olika system och enheter.
    - √ñvervakar, uppt√§cker och skickar varningar vid misst√§nkt aktivitet.
    - Lagrar loggar f√∂r b√•de historisk analys och krav p√• datalagring.

  SIEM-processen best√•r av tre steg:
    1. Insamling och aggregering ‚Äì loggar fr√•n t.ex. brandv√§ggar, servrar och routrar samlas i en central plats. Data parsas f√∂r att bli mer l√§sbar.
    2. Normalisering ‚Äì data omvandlas till ett standardiserat, strukturerat format f√∂r att kunna bearbetas och s√∂kas effektivt.
    3. Analys ‚Äì med hj√§lp av regler, villkor och korrelation mellan h√§ndelser identifieras m√∂nster som tyder p√• hot, vilket genererar varningar.

Exempel p√• SIEM-verktyg: AlienVault OSSIM, Chronicle, Elastic, Exabeam, IBM QRadar, LogRhythm och Splunk.

üëâ Kort sagt: SIEM centraliserar och strukturerar loggdata fr√•n m√•nga k√§llor f√∂r att ge s√§kerhetsteam m√∂jlighet att effektivt uppt√§cka, analysera och hantera potentiella hot.

Exempel p√• en logg:
  üëâApril 3 11:01:21 server sshd[1088]: Failed password for user nuhara from 218.124.14.105 port 5023
      host = server
      process = sshd
      source_user = nuhara
      source ip = 218.124.14.105
      source port = 5023

Security Orchestration, Automation, and Response (SOAR)
  Samling av applikationer och v√§rktyg samt workflows som anv√§nder automation till att aggera mot s√§kerhets event.








Module 2
Network monitoring and analysis

Indicators of compromise (IOC)
  Observerbara bevis som tyder p√• tecken p√• en potentiell s√§kerhetsincident.
  Data exfiltration: Obeh√∂rig √∂verf√∂ring av data fr√•n ett system till ett annat s√• som username, password som attackerare g√∂r.

N√§tverks√∂vervakning √§r avg√∂rande f√∂r att uppt√§cka avvikelser och misst√§nkt aktivitet i n√§tverkstrafiken. 
Genom att samla in och analysera data fr√•n n√§tverkskommunikation kan s√§kerhetsteam skapa en baseline (normal beteendeniv√•) och j√§mf√∂ra mot den f√∂r att identifiera avvikelser.

Metoder f√∂r n√§tverks√∂vervakning:
  Fl√∂desanalys: unders√∂ker protokoll, portar och paketfl√∂den. Avvikelser, som felaktiga port-protokoll-kombinationer, kan indikera attacker (t.ex. C2-kommunikation).
  Paketinneh√•ll (payload): analyserar datan i n√§tverkspaketen, ofta f√∂r att hitta misst√§nkt trafik som kan tyda p√• datal√§ckage.
  Tidsm√∂nster: avvikelser i n√§r trafiken sker (t.ex. stora datam√§ngder utanf√∂r normala arbetstider) kan signalera intr√•ng.

Skydd och roller:
  SOC (Security Operations Center): fokuserar p√• s√§kerhet, uppt√§ckt och respons p√• hot.
  NOC (Network Operations Center): fokuserar p√• n√§tverkets prestanda, tillg√§nglighet och driftst√∂rningar.

Verktyg f√∂r n√§tverks√∂vervakning:
  IDS (Intrusion Detection Systems): √∂vervakar och varnar vid intr√•ngsf√∂rs√∂k.
  Protokollanalysatorer / Packet sniffers (t.ex. Wireshark, tcpdump): f√•ngar och analyserar n√§tverkstrafik i detalj.

üëâ Kort sagt: Genom att k√§nna sitt n√§tverk, fastst√§lla en baseline och anv√§nda √∂vervakningsverktyg kan organisationer snabbt uppt√§cka intr√•ng och skydda sina system.


Inom TCP/IP modellen som best√•r av 
  - Application
  - Transport
  - Internet
  - Network Access
√Ñr allts√• "Internet" d√§r alla packets och kommunikationen sker.


IPv4 och IPv6 √§r uppbyggda p√• olika s√§tt som g√∂r att Header f√∂r dessa ser olika ut.

IPv4: √Ñr mest anv√§nd verisionen av IP, det finns 13 f√§lt i det "header":
  - Version: Detta f√§lt anger IP-version. F√∂r en IPv4-header anv√§nds IPv4.
  - Internet Header Length (IHL): Detta f√§lt anger l√§ngden p√• IPv4-headern, inklusive eventuella alternativ (Options).
  - Type of Service (ToS): Detta f√§lt inneh√•ller information om paketets prioritet f√∂r leverans.
  - Total Length: Detta f√§lt anger den totala l√§ngden p√• hela IP-paketet, inklusive headern och datan.
  - Identification: Paket som √§r f√∂r stora f√∂r att skickas delas upp i fragment. Detta f√§lt anger en unik identifierare f√∂r fragmenten av det ursprungliga IP-paketet, s√• att de kan s√§ttas ihop igen vid mottagaren.
  - Flags: Detta f√§lt inneh√•ller information om fragmentering, t.ex. om paketet har delats upp och om det finns fler fragment p√• v√§g.
  - Fragment Offset: Detta f√§lt anv√§nds f√∂r att placera fragmenten i r√§tt ordning n√§r paketet s√§tts ihop igen.
  - Time to Live (TTL): Detta f√§lt begr√§nsar hur l√§nge ett paket kan cirkulera i n√§tverket och f√∂rhindrar att det skickas runt mellan routrar o√§ndligt.
  - Protocol: Detta f√§lt anger vilket protokoll som anv√§nds f√∂r datapaketets inneh√•ll.
  - Header Checksum: Detta f√§lt inneh√•ller ett checksummev√§rde som anv√§nds f√∂r att kontrollera om headern har n√•gra fel.
  - Source Address: Detta f√§lt anger avs√§ndarens IP-adress.
  - Destination Address: Detta f√§lt anger mottagarens IP-adress.
  - Options: Detta f√§lt √§r valfritt och kan anv√§ndas f√∂r att till√§mpa exempelvis s√§kerhetsinst√§llningar f√∂r paketet.
  
IPv6: Har √∂kat pga dess stora adressutrymme. Det finns √•tta f√§lt i "header"
  - Version: Detta f√§lt anger IP-version. F√∂r en IPv6-header anv√§nds IPv6.
  - Traffic Class: Detta f√§lt motsvarar ungef√§r Type of Service i IPv4. Det anger paketets prioritet eller klass f√∂r att underl√§tta leverans.
  - Flow Label: Detta f√§lt identifierar paket som tillh√∂r samma fl√∂de. Ett fl√∂de √§r en f√∂ljd av paket som skickas fr√•n en specifik k√§lla.
  - Payload Length: Detta f√§lt anger l√§ngden p√• datapaketets inneh√•ll (dvs. datadelen).
  - Next Header: Detta f√§lt anger vilken typ av header som f√∂ljer efter IPv6-headern, t.ex. TCP.
  - Hop Limit: Detta f√§lt fungerar som Time to Live (TTL) i IPv4. Det begr√§nsar hur l√§nge ett paket f√•r f√§rdas i n√§tverket innan det kastas bort.
  - Source Address: Detta f√§lt anger avs√§ndarens IP-adress.
  - Destination Address: Detta f√§lt anger mottagarens IP-adress.


Wireshark
  √Ñr ett √∂ppet verktyg f√∂r n√§tverksanalys som anv√§nder ett grafiskt gr√§nssnitt f√∂r att visualisera och analysera n√§tverkstrafik.
    - Display filters: G√∂r det m√∂jligt att filtrera p√• protokoll, IP-adresser, portar och andra f√§lt.
    - J√§mf√∂relseoperatorer: Anv√§nds f√∂r att specificera v√§rden (t.ex. ==, !=, >, < eller motsvarande f√∂rkortningar). De kan kombineras med logiska operatorer som and och or.
    - Contains: Filtrerar paket som inneh√•ller en specifik textstr√§ng.
    - Matches: Filtrerar paket med hj√§lp av regulj√§ra uttryck (regex).
    - Filter toolbar: H√§r skriver man in filter, exempelvis dns f√∂r att bara visa DNS-paket. Wireshark anv√§nder √§ven f√§rger f√∂r olika protokoll.
      Filtreringstyper:
        Protokoll: Exempelvis dns, http, ftp, ssh, arp, telnet, icmp.
        IP-adress: ip.addr == 172.21.224.2, ip.src (k√§lla), ip.dst (destination).
        MAC-adress: eth.addr == 00:70:f4:23:18:c4.
        Portar: udp.port == 53, tcp.port == 25.
Follow streams: G√∂r det m√∂jligt att f√∂lja en konversation (stream) mellan tv√• enheter och √•terst√§lla kommunikationen i ett mer l√§sbart format, t.ex. 
en HTTP-f√∂rfr√•gan och dess svar.
üëâ Kort sagt: Wireshark l√•ter dig filtrera och analysera n√§tverkstrafik p√• ett effektivt s√§tt genom att anv√§nda filter f√∂r protokoll, adresser, portar och str√∂mmar.


TCP dump
  √Ñr ett kraftfullt kommandoradsverktyg f√∂r att analysera n√§tverkstrafik i realtid. 
  Det anv√§nds ofta av n√§tverksadministrat√∂rer och s√§kerhetsexperter f√∂r fels√∂kning, √∂vervakning och insamling av data.
Huvudpunkter om TCPdump:
  Funktion: f√•ngar upp n√§tverkspaket som passerar ett n√§tverksgr√§nssnitt (t.ex. eth0) Kan visa paketen direkt i terminalen eller spara ner i en fil (.pcap -format) f√∂r senare.
  Protokollst√∂d: st√∂djer dem flesta s√• som TCP, UPD, ICMP, ARP och IPv4/IPv6.
  Filter: Precis som wireshark kan det filtrera p√• protokoll, IP, portar m.m. Exempel: 
    - tcpdump port 80 => Visar trafik p√• port 80
    - tcpdump host 8.8.8.8 => visar trafik till eller fr√•n 8.8.8.8
    - tcpdump src 192.168.1.10 => visar trafik fr√•n en viss k√§lla.
    - tcp dst port 22 => visar trafik till port 22 (SSH)
Mer Exempel
    - sudo tcpdump -i eth0 => F√•ngar all trafik n√§tverksgr√§nssnittet eth0
    - sudo tcpdump -i eth0 -w capture.pcap => sparar all f√•ngad trafik i fil capture.pcap
üëâ Kort sagt: TCPdump √§r Wireshark fast i terminalen ‚Äì snabbare, mer resurssn√•lt, men mindre anv√§ndarv√§nligt f√∂r nyb√∂rjare.
  olika options och dess betydelse
  -i => Interface, Anger vilket n√§tverksgr√§nssnitt som ska anv√§ndas f√∂r att snappa upp trafik.
  -v => Verbose, G√∂r utskriften mer detaljerad. Kan upprepas (-vv eller -vvv) f√∂r √§nnu mer information om paketen.
  -D => List Devices, Visar en lista √∂ver alla tillg√§ngliga n√§tverksgr√§nssnitt som tcpdump kan lyssna p√•.
  -c 2 (eller n√•tt annat nummer) Count, Anger hur m√•nga paket som ska f√•ngas innan tcpdump avslutas.
  -w => L√•ter oss spara n√§tverkspaket till en fil f√∂r senare analys.







Module 3
Detection & Analysis Phase: 
  S√§kerhetsteam anv√§nder verktyg som IDS och SIEM f√∂r att uppt√§cka och analysera incidenter. En utmaning √§r att dessa verktyg bara kan uppt√§cka det de √§r konfigurerade f√∂r.
Threat hunting: 
  Proaktiv metod d√§r s√§kerhetsexperter aktivt letar efter hot som automatiserade verktyg missar, t.ex. sv√•ruppt√§ckt fil-l√∂s malware. Kombinerar m√§nsklig analys med teknik.
Threat intelligence: 
  Information om hot fr√•n k√§llor som branschrapporter, myndighetsvarningar och hotdatastreams (t.ex. IP-adresser, dom√§ner, fil-hashar). 
  Kan centraliseras via en Threat Intelligence Platform (TIP) f√∂r att f√∂rb√§ttra detektion och prioritering.
Cyber deception: 
  Tekniker som avsiktligt lurar angripare. Exempel: honeypots, dvs. falska resurser eller filer som angripare lockas till. N√§r de f√∂rs√∂ker f√• √•tkomst triggas en varning.

üëâ Kort sagt: Ut√∂ver traditionella verktyg st√§rker organisationer sin detektion med proaktiv threat hunting, 
  hotinformation och cyber deception f√∂r att uppt√§cka hot som annars kan f√∂rbli dolda.


CI/CD
CI/CD-pipelines g√∂r mjukvaruutveckling snabbare men √∂ppnar ocks√• f√∂r nya s√•rbarheter. 
D√§rf√∂r √§r kontinuerlig √∂vervakning viktig f√∂r att automatiskt uppt√§cka ovanlig aktivitet och Indicators of Compromise (IoCs).
Vanliga IoCs i CI/CD:
  - Obeh√∂riga kod√§ndringar: misst√§nkta commits fr√•n fel anv√§ndare, tider eller platser.
  - Avvikande deployment-m√∂nster: distributioner vid ovanliga tidpunkter, till fel system eller fr√•n fel konton.
  - Komprometterade beroenden: k√§nda s√•rbarheter (CVEs), ov√§ntade nya beroenden, nedladdningar fr√•n os√§kra k√§llor.
  - Ovanlig pipeline-k√∂rning: steg som misslyckas, tar l√§ngre tid √§n normalt, eller k√∂rs i fel ordning.
  - F√∂rs√∂k till sekretsexponering: obeh√∂rig √•tkomst till hemligheter eller h√•rdkodade hemligheter i kod.

Metoder f√∂r att hitta hot:
  - Omfattande loggning: analysera k√∂rningsloggar, kodcommits, √•tkomstloggar och deployment-loggar med automatiska baselines f√∂r att uppt√§cka avvikelser.
  - SIEM-integration: koppla CI/CD-loggar till ett SIEM f√∂r att uppt√§cka anomalier, matcha k√§nda IoCs (t.ex. skadliga filhashar, C2-anslutningar) och trigga regler.
  - Realtidsvarningar: notifiera omedelbart om misst√§nkta h√§ndelser (t.ex. kodf√∂r√§ndringar, misslyckade builds, ovanlig n√§tverkstrafik).
  - Prestanda√∂vervakning: uppt√§cka ovanlig resursanv√§ndning eller l√•ngsamma pipelines som kan indikera attacker.
  - Kontinuerlig s√•rbarhetsskanning: hitta och patcha svagheter i CI/CD-verktyg, plugins och containers.

F√∂rdelar med proaktiv √∂vervakning:
  - Snabb respons ‚Üí stoppa attacker innan de orsakar skada.
  - Minskad p√•verkan ‚Üí begr√§nsa angriparnas tid i systemet.
  - B√§ttre hotf√∂rst√•else ‚Üí l√§rdomar om angripares metoder st√§rker framtida s√§kerhet.

üëâ Kort sagt: Automatiserad √∂vervakning av CI/CD med loggning, SIEM, varningar, prestanda√∂vervakning och s√•rbarhetsskanning g√∂r det m√∂jligt att uppt√§cka IoCs tidigt, 
  svara snabbt och skydda mjukvaruf√∂rs√∂rjningskedjan.




























