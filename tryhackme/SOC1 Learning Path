
Pyramid of Pain

"Pyramid of Pain" Ã¤r ett begrepp inom cybersÃ¤kerhet som skapades av David Bianco. 
Det Ã¤r en modell som visar hur svÃ¥rt det Ã¤r fÃ¶r en angripare att fortsÃ¤tta sina attacker nÃ¤r du som fÃ¶rsvarare stoppar eller stÃ¶r deras olika indikatorer.
Modellen Ã¤r formad som en pyramid med olika nivÃ¥er:
1. Hash values
  Exempel: MD5/SHA1/SHA256-hashar av skadlig kod.
  Enkla att byta fÃ¶r angriparen (bara kompilera om eller Ã¤ndra filen).
  Ger liten smÃ¤rta.

2. IP addresses
  Angriparens C2- eller botnet-servrar.
  LÃ¤tta att byta, de kan hyra nya servrar eller anvÃ¤nda proxy/botnÃ¤t.

3. Domain names
  Angriparens domÃ¤ner som anvÃ¤nds fÃ¶r C2 eller phishing.
  Lite svÃ¥rare och dyrare att ersÃ¤tta Ã¤n IP-adresser, men fortfarande relativt enkelt.

4. Network/Host Artifacts
  T.ex. registernycklar, filer pÃ¥ systemet, ovanliga processer.
  KrÃ¤ver mer arbete fÃ¶r angriparen att Ã¤ndra eftersom det Ã¤r kopplat till deras verktyg.

5. Tools
  Malware, skript, exploits som angriparen anvÃ¤nder.
  Om du kan upptÃ¤cka och blockera deras verktyg blir det riktigt jobbigt fÃ¶r dem â€“ de mÃ¥ste utveckla eller skaffa nya.

6. Tactics, Techniques, and Procedures (TTPs)
  Angriparens arbetsmetoder och beteendemÃ¶nster (hur de rÃ¶r sig i nÃ¤tverket, hur de sprider sig, hur de stjÃ¤l data).
  SvÃ¥rast att Ã¤ndra fÃ¶r angriparen eftersom det bygger pÃ¥ deras kunskap, trÃ¤ning och resurser.
  Ger stÃ¶rst "pain" om du upptÃ¤cker och stoppar dem hÃ¤r.

ğŸ‘‰ PoÃ¤ngen: Ju hÃ¶gre upp i pyramiden du kan fÃ¶rsvara dig, desto svÃ¥rare och dyrare blir det fÃ¶r angriparen att fortsÃ¤tta attacken.

TTPs stÃ¥r fÃ¶r Tactics, Techniques & Procedures.
  Innefattar MITRE ATTACK Matrix som menas alla steg som behÃ¶ver tas fÃ¶r att nÃ¥ sitt mÃ¥l, startar med phishing fÃ¶rsÃ¶k fÃ¶r att nÃ¥ en startpunkt.





Cyber Kill Chain
  Ã„r en modell som utvecklades av Lockheed Martin och anvÃ¤nds fÃ¶r att beskriva de olika stegen i en cyberattack. 
  Syftet Ã¤r att fÃ¶rstÃ¥ angriparens metodik och dÃ¤rmed kunna upptÃ¤cka och stoppa attacker i ett tidigt skede. HÃ¤r Ã¤r en beskrivning av varje steg:

1. Reconnaissance (Spaning)
  I detta inledande steg samlar angriparen information om mÃ¥let. Det kan handla om att kartlÃ¤gga nÃ¤tverk, identifiera sÃ¥rbara system, 
  eller samla in data om anstÃ¤llda genom sociala medier.
  Exempel: AnvÃ¤nda verktyg som Nmap fÃ¶r portskanning eller OSINT fÃ¶r att hitta e-postadresser.

2. Weaponization (BevÃ¤pning)
  HÃ¤r fÃ¶rbereder angriparen sitt verktyg fÃ¶r attacken. Vanligtvis kombineras ett exploateringsverktyg med en skadlig nyttolast (payload).
  Exempel: Skapa ett Word-dokument med inbÃ¤ddad makro-malware eller bygga en trojan som kan kÃ¶ras nÃ¤r offret Ã¶ppnar filen.

3. Delivery (Leverans)
  Attackverktyget levereras till mÃ¥let. Detta kan ske pÃ¥ flera sÃ¤tt â€“ via e-post (phishing), USB-enheter, skadliga lÃ¤nkar, eller utnyttjande av osÃ¤kra tjÃ¤nster.
  Exempel: Skicka ett e-postmeddelande med en bifogad infekterad fil.

4. Exploitation (Utnyttjande)
  NÃ¤r mÃ¥let interagerar med den levererade attacken utnyttjas en sÃ¥rbarhet. HÃ¤r fÃ¥r angriparen tillgÃ¥ng till systemet.
  Exempel: Ett klick pÃ¥ en lÃ¤nk som aktiverar en sÃ¥rbarhet i webblÃ¤saren, eller att Ã¶ppna ett dokument som kÃ¶r skadlig kod.

5. Installation (Installation)
  Efter att sÃ¥rbarheten utnyttjats installeras skadlig kod, ofta i form av en trojan eller ett bakdÃ¶rrsprogram, fÃ¶r att behÃ¥lla Ã¥tkomst till systemet.
  Exempel: En keylogger eller ett RAT (Remote Access Trojan) installeras pÃ¥ den infekterade datorn.

6. Command & Control (C2 / Kommando & Kontroll)
  Angriparen etablerar en kommunikationskanal mellan det infekterade systemet och sin egen server. Detta gÃ¶r att angriparen kan skicka instruktioner och ta emot data.
  Exempel: Malware kommunicerar med angriparens C2-server via HTTP/HTTPS eller DNS-tunnling.

7. Actions on Objectives (GenomfÃ¶rande av mÃ¥l)
  Slutligen utfÃ¶r angriparen sina mÃ¥l. Detta kan vara datastÃ¶ld, spionage, sabotage, kryptering av filer (ransomware) eller att sprida sig vidare i nÃ¤tverket.
  Exempel: Exfiltrering av kÃ¤nsliga filer, kryptering av databaser, eller att sabotera produktion.

ğŸ‘‰ PoÃ¤ngen med Cyber Kill Chain 
  Ã„r att en fÃ¶rsvarare inte nÃ¶dvÃ¤ndigtvis mÃ¥ste stoppa angriparen i alla steg â€“ det rÃ¤cker att upptÃ¤cka och blockera attacken i ett av stegen fÃ¶r att fÃ¶rhindra att mÃ¥let uppnÃ¥s.






Unified Kill Chain
  Den Unified Kill Chain Ã¤r ett koncept inom cybersÃ¤kerhet som anvÃ¤nds fÃ¶r att beskriva och analysera hur cyberattacker genomfÃ¶rs steg fÃ¶r steg. 
  Det Ã¤r en vidareutveckling och sammanslagning av olika â€œkill chainâ€-modeller, 
  sÃ¥som Lockheed Martins kill chain och MITRE ATT&CK-ramverket, fÃ¶r att ge en mer komplett bild av en attack.

  Vad Ã¤r en kill chain?
    En kill chain beskriver de olika steg en angripare tar fÃ¶r att lyckas med en attack. Genom att fÃ¶rstÃ¥ dessa steg kan fÃ¶rsvarare identifiera var de kan stoppa attacken.

  Unified Kill Chain
    Syfte: Att skapa en mer holistisk modell som tÃ¤cker alla faser av en attack â€“ frÃ¥n initial rekognosering till efterattack-aktiviteter.
    FÃ¶rdel: Ger ett gemensamt sprÃ¥k och struktur fÃ¶r bÃ¥de detektion och respons.
    InnehÃ¥ll: Kombinerar ofta steg frÃ¥n olika modeller (Lockheed Martin, MITRE ATT&CK) till en enhetlig kedja.

  VarfÃ¶r Ã¤r Unified Kill Chain viktig?
    HjÃ¤lper sÃ¤kerhetsteam att fÃ¶rstÃ¥ attacker som helhet.
    GÃ¶r det lÃ¤ttare att planera fÃ¶rebyggande Ã¥tgÃ¤rder.
    Integrerar olika ramverk fÃ¶r mer effektiv detektion och respons.


Threat modelling
 Ã„r en metod fÃ¶r att identifiera, fÃ¶rstÃ¥ och hantera mÃ¶jliga hot mot ett system. HÃ¤r Ã¤r en detaljerad fÃ¶rklaring:

  Definition
    Threat modeling Ã¤r processen dÃ¤r man systematiskt analyserar ett system fÃ¶r att upptÃ¤cka potentiella sÃ¤kerhetshot, sÃ¥rbarheter och angripares mÃ¶jliga angreppsmetoder. 
    MÃ¥let Ã¤r att designa systemet sÃ¥ att riskerna minimeras.

  GrundlÃ¤ggande steg i threat modeling
    1. Identifiera tillgÃ¥ngar (Assets)
      - Vilka data, system eller resurser Ã¤r vÃ¤rdefulla?
    
    2. Skapa en arkitekturÃ¶versikt (Architecture Overview)
      - Rita upp systemets komponenter, datalagring, kommunikationsflÃ¶den etc.
    
    3. Identifiera hot (Threat Identification)
      - AnvÃ¤nd ramverk som STRIDE (Spoofing, Tampering, Repudiation, Information disclosure, Denial of service, Elevation of privilege) fÃ¶r att lista mÃ¶jliga attacker.
    
    4. Identifiera sÃ¥rbarheter (Vulnerability Analysis)
      - Se vilka delar av systemet som Ã¤r svaga eller kan utnyttjas.
    
    5. Prioritera risker (Risk Prioritization)
      - BedÃ¶m sannolikhet och pÃ¥verkan av olika hot fÃ¶r att fokusera pÃ¥ de viktigaste.
    
    6. FÃ¶reslÃ¥ motÃ¥tgÃ¤rder (Mitigation)
      - Designa sÃ¤kerhetsÃ¥tgÃ¤rder som minskar eller eliminerar hoten.


  VarfÃ¶r threat modeling Ã¤r viktigt
    - GÃ¶r sÃ¤kerhet proaktiv istÃ¤llet fÃ¶r reaktiv.
    - HjÃ¤lper utvecklare att bygga sÃ¤krare system frÃ¥n bÃ¶rjan.
    - Integreras ofta i DevSecOps och sÃ¤ker mjukvaruutveckling.




Diamond Model
  Ã„r en analysmodell inom cyber security som anvÃ¤nds fÃ¶r att strukturera och fÃ¶rstÃ¥ cyberattacker. 
  Den introducerades av Caltagirone, Pendergast och Betz 2013 och anvÃ¤nds ofta inom threat intelligence och incidentanalys.

  IdÃ©n Ã¤r att varje intrÃ¥ng eller hÃ¤ndelse kan beskrivas genom fyra centrala element i en diamantformad modell:
    1. Adversary â€“ angriparen eller gruppen bakom attacken. Attackerare kallas Adversary Operator.
    2. Capability â€“ de verktyg, metoder och tekniker som angriparen anvÃ¤nder.
    3. Infrastructure â€“ den infrastruktur som mÃ¶jliggÃ¶r attacken, till exempel servrar, domÃ¤ner, nÃ¤tverk eller malware-distribution.
    4. Victim â€“ den organisation, individ eller system som attacken riktas mot. Kallas Victim Personae
ğŸ“Œ Mitten av diamanten representerar â€Eventâ€, alltsÃ¥ sjÃ¤lva hÃ¤ndelsen som kopplar samman alla fyra hÃ¶rn.

Exempel
  - Adversary: En APT-grupp frÃ¥n en viss region.
  - Capability: En zero-day exploit och ett RAT (Remote Access Trojan).
  - Infrastructure: Command & Control-servrar, phishing-domÃ¤ner.
  - Victim: Ett fÃ¶retag i finanssektorn.

Syfte
  - Ge en systematisk analys av attacker.
  - HjÃ¤lpa att identifiera mÃ¶nster och samband mellan olika attacker.
  - UnderlÃ¤tta threat hunting och attribution (vem ligger bakom attacken).
  - StÃ¶tta utvecklingen av defensiva Ã¥tgÃ¤rder.

Diamond-modellen kan kompletteras med sex valfria meta-features som ger extra kontext och underrÃ¤ttelsevÃ¤rde fÃ¶r varje hÃ¤ndelse:
  1. Timestamp â€“ datum/tid fÃ¶r hÃ¤ndelsen (start/stop). Viktigt fÃ¶r att hitta tidsmÃ¶nster och indikera tidzoner eller arbetstider.
  2. Phase â€“ vilken fas i attackkedjan hÃ¤ndelsen tillhÃ¶r (t.ex. Reconnaissance, Weaponization, Delivery, Exploitation, Installation, Command & Control, Actions on Objective). 
      Visar att attacker ofta Ã¤r flera fÃ¶ljdskeden.
  3. Result â€“ utfall eller efter-tillstÃ¥nd (t.ex. success, failure, unknown) och koppling till CIA-triaden 
      (konfidentialitet, integritet, tillgÃ¤nglighet) eller konkreta fÃ¶ljder (t.ex. exfiltration av lÃ¶senord).
  4. Direction â€“ riktningen fÃ¶r aktiviteten mellan parter (t.ex. Victimâ†’Infrastructure, Infrastructureâ†’Victim, Adversaryâ†’Infrastructure, 
      Bidirectional, Unknown). HjÃ¤lper sÃ¤rskilja host- vs nÃ¤tverkshÃ¤ndelser.
  5. Methodology â€“ generell klassificering av intrÃ¥nget (t.ex. phishing, DDoS, breach, port scan).
  6. Resources â€“ externa resurser som mÃ¶jliggjorde attacken (mjukvara, kunskap, information, hÃ¥rdvara, pengar, anlÃ¤ggningar, nÃ¤taccess etc.).

Kort sagt: meta-features Ã¤r inte obligatoriska, men de ger viktigt tids-, fas-, riktnings-, utfalls- och resurs-kontext som fÃ¶rbÃ¤ttrar analys, korrelation och fÃ¶rstÃ¥else av intrÃ¥ng.







ğŸ”¹MITRE Corporation
  Det Ã¤r en amerikansk icke-vinstdrivande organisation som arbetar med forskning och utveckling fÃ¶r bland annat fÃ¶rsvar, flyg, sjukvÃ¥rd och cybersÃ¤kerhet.

ğŸ”¹ MITRE ATT&CK
  Inom cybersÃ¤kerhet Ã¤r MITRE mest kÃ¤nt fÃ¶r ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge).
  Det Ã¤r en globalt tillgÃ¤nglig kunskapsbas som beskriver angripares beteenden, alltsÃ¥ vilka taktiker, tekniker och procedurer TTPs (Tactics, Techniques, and Procedures)  
  de anvÃ¤nder i verkliga attacker.

  Ramverket anvÃ¤nds av:
    ğŸ‘‰SOC-analytiker â†’ fÃ¶r att fÃ¶rstÃ¥ och upptÃ¤cka attacker.
    ğŸ‘‰Red team & blue team â†’ fÃ¶r att simulera attacker respektive fÃ¶rsvara sig mot dem.
    ğŸ‘‰Threat intelligence â†’ fÃ¶r att kartlÃ¤gga och analysera hotaktÃ¶rer.
    ğŸ‘‰SÃ¤kerhetslÃ¶sningar â†’ fÃ¶r att mÃ¤ta tÃ¤ckning och effektivitet av detektionssystem.

  ğŸ“Œ Exempel:
    Om en angripare fÃ¶rsÃ¶ker fÃ¥ tag pÃ¥ administratÃ¶rsrÃ¤ttigheter kan deras metod beskrivas i MITRE ATT&CK under tekniken â€œPrivilege Escalationâ€.

ğŸ‘‰ SÃ¥ nÃ¤r man pratar om MITRE inom cybersÃ¤kerhet menar man nÃ¤stan alltid MITRE ATT&CK-ramverket, som Ã¤r ett centralt verktyg fÃ¶r att fÃ¶rstÃ¥, analysera och fÃ¶rsvara mot cyberattacker.




MITRE CAR (Cyber Analytics Repository)
  Vad det Ã¤r:
    ğŸ”¹MITRE CAR Ã¤r en samling av analysrecept (â€analyticsâ€) som beskriver hur man kan upptÃ¤cka angripares beteenden i loggar och telemetri, ofta kopplade direkt till MITRE ATT&CK-tekniker.
  Syfte:
    ğŸ”¹Medan ATT&CK beskriver vad angriparna gÃ¶r, sÃ¥ beskriver CAR hur man kan upptÃ¤cka det i praktiken. Det fungerar som en brygga mellan teori och verklig SOC/blue team-analys.

  Exempel:
    ğŸ”¹ATT&CK sÃ¤ger att angripare kan anvÃ¤nda PowerShell fÃ¶r att exekvera kod (T1059.001).
    ğŸ”¹CAR kan dÃ¥ ha en analys som: â€œLeta efter ovanliga PowerShell-kommandon i processloggar, sÃ¤rskilt de som innehÃ¥ller Base64-kodning.â€

  AnvÃ¤ndningsomrÃ¥den:
    ğŸ”¹SOC-analytiker kan anvÃ¤nda CAR som mallar fÃ¶r att skapa detektionsregler i SIEM/XDR.
    ğŸ”¹SÃ¤kerhetsteam kan kartlÃ¤gga sina gap i detektion.
    ğŸ”¹Ger en praktisk koppling mellan hotintelligens och loggdata.

ğŸ‘‰ Man kan alltsÃ¥ sÃ¤ga:
  ğŸ”¹MITRE ATT&CK = angriparens karta (vad de gÃ¶r)
  ğŸ”¹MITRE CAR = analytikerns verktygslÃ¥da (hur man hittar det i loggarna)



MITRE ENGAGE
  Vad det Ã¤r:
    ğŸ”¹MITRE ENGAGE Ã¤r ett ramverk fÃ¶r aktiva fÃ¶rsvarsstrategier och motÃ¥tgÃ¤rder mot cyberangripare.
      Det Ã¤r i praktiken en guide fÃ¶r deception, stÃ¶rning och fÃ¶rdrÃ¶jning av angripare nÃ¤r de vÃ¤l Ã¤r inne i systemet.
  Syfte:
    Till skillnad frÃ¥n ATT&CK (som beskriver angriparnas beteenden) och CAR (som beskriver hur man upptÃ¤cker dem), sÃ¥ handlar ENGAGE om:
      ğŸ”¹Hur man kan agera aktivt fÃ¶r att fÃ¶rsvÃ¥ra fÃ¶r angripare.
      ğŸ”¹Hur man lurar eller vilseleder angripare (exempelvis med honeypots, falska filer, vilseledande konton).
      ğŸ”¹Hur man samlar in information om angriparen under pÃ¥gÃ¥ende intrÃ¥ng.

  Exempel pÃ¥ tekniker inom ENGAGE:
  ğŸ”¹Placera ut decoy credentials (falska lÃ¶senord eller konton) som avslÃ¶jar angriparen nÃ¤r de anvÃ¤nds.
  ğŸ”¹Bygga honeynets/honeypots fÃ¶r att attrahera angripare.
  ğŸ”¹AnvÃ¤nda falska systemkonfigurationer fÃ¶r att slÃ¶sa angriparens tid.
  ğŸ”¹Aktivt manipulera angriparens uppfattning om nÃ¤tverket.

  JÃ¤mfÃ¶relse:
  ğŸ”¹ATT&CK â†’ Vad angripare gÃ¶r.
  ğŸ”¹CAR â†’ Hur vi kan upptÃ¤cka dem.
  ğŸ”¹ENGAGE â†’ Hur vi kan aktivt stÃ¶ra, lura eller pÃ¥verka angriparna.

ğŸ“Œ Det Ã¤r alltsÃ¥ ett ramverk fÃ¶r defense-in-depth med fokus pÃ¥ deception och proaktivt fÃ¶rsvar â€“ nÃ¥got som anvÃ¤nds i avancerade SOC-miljÃ¶er och militÃ¤r cybersÃ¤kerhet.




MITRE D3FEND
  Ã„r ett systerramverk till ATT&CK, men istÃ¤llet fÃ¶r att beskriva angriparens beteenden sÃ¥ beskriver det fÃ¶rsvarstekniker.
  Vad det Ã¤r:
    ğŸ”¹D3FEND Ã¤r en taxonomi Ã¶ver cyberfÃ¶rsvarstekniker.
    ğŸ”¹Bygger pÃ¥ samma struktur som ATT&CK (taktiker â†’ tekniker).
    ğŸ”¹Kopplar angreppstekniker (ATT&CK) till fÃ¶rsvarsmekanismer (D3FEND).

  Syfte:
    ğŸ”¹HjÃ¤lpa sÃ¤kerhetsteam att fÃ¶rstÃ¥ vilka defensiva Ã¥tgÃ¤rder som motverkar specifika attacker.
    ğŸ”¹Ge en gemensam terminologi fÃ¶r fÃ¶rsvar, precis som ATT&CK ger fÃ¶r attacker.
    ğŸ”¹StÃ¶dja SOC, red/blue/purple teaming och arkitekter i att designa robusta fÃ¶rsvar.

  Exempel:
    ğŸ”¹ATT&CK: Angriparen anvÃ¤nder Credential Dumping (T1003) fÃ¶r att komma Ã¥t lÃ¶senord.
    ğŸ”¹D3FEND: FÃ¶reslÃ¥r fÃ¶rsvarstekniker som Credential Hardening, Credential Monitoring eller Process Isolation.

  Hur det hÃ¤nger ihop med de andra:
    ğŸ”¹ATT&CK â†’ kartlÃ¤gger angriparnas angreppstekniker.
    ğŸ”¹CAR â†’ visar hur vi kan upptÃ¤cka dessa i loggar och analys.
    ğŸ”¹ENGAGE â†’ ger aktiva fÃ¶rsvarsstrategier fÃ¶r att stÃ¶ra angriparen.
    ğŸ”¹D3FEND â†’ definierar vilka fÃ¶rsvarstekniker som stoppar eller fÃ¶rsvÃ¥rar ATT&CK-teknikerna.

ğŸ‘‰ Man kan alltsÃ¥ sÃ¤ga att:
  ğŸ”¹ATT&CK Ã¤r angriparens lexikon.
  ğŸ”¹D3FEND Ã¤r fÃ¶rsvararens lexikon.
  ğŸ”¹CAR Ã¤r detektorns manual.
  ğŸ”¹ENGAGE Ã¤r stridsplanen fÃ¶r att fÃ¶rvirra fienden.




Cyber Threat Intel
  
  CTI = (Cyber Threat Intelligence)
  IOC = (Indicator of Compromise)
  IOA = (Indicator of Attack)
  TTP = (Tactics, Techniques, and Procedures)

Threat intelligence handlar om att fÃ¶rstÃ¥ relationen mellan organisationens operativa miljÃ¶ och dess motstÃ¥ndare. Det kan delas in i fÃ¶ljande kategorier:
  ğŸ”¹Strategisk intel: 
      Ã–vergripande analys av hotlandskapet, trender och mÃ¶nster som kan pÃ¥verka affÃ¤rsbeslut. Exempel: en Ã¥rlig rapport om ransomware som fÃ¶rutspÃ¥r nya angreppsmetoder.
  ğŸ”¹Taktisk intel: 
      BedÃ¶mning av angripares beteenden genom analys av TTP:er (taktiker, tekniker och procedurer). Exempel: varningsnotiser om nya sÃ¤tt att missbruka Visual Basic i malspam.
  ğŸ”¹Operationell intel: 
      Information om specifika kampanjer, angriparens motiv och intentioner. HjÃ¤lper till att identifiera vilka tillgÃ¥ngar (personer, processer, teknologier) som kan vara mÃ¥ltavlor.
  ğŸ”¹Teknisk intel: 
      Konkreta indikatorer och artefakter, t.ex. IP-adresser eller filhashar som anvÃ¤nds i attacker.








