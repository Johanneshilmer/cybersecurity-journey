
Pyramid of Pain

"Pyramid of Pain" √§r ett begrepp inom cybers√§kerhet som skapades av David Bianco. 
Det √§r en modell som visar hur sv√•rt det √§r f√∂r en angripare att forts√§tta sina attacker n√§r du som f√∂rsvarare stoppar eller st√∂r deras olika indikatorer.
Modellen √§r formad som en pyramid med olika niv√•er:
1. Hash values
  Exempel: MD5/SHA1/SHA256-hashar av skadlig kod.
  Enkla att byta f√∂r angriparen (bara kompilera om eller √§ndra filen).
  Ger liten sm√§rta.

2. IP addresses
  Angriparens C2- eller botnet-servrar.
  L√§tta att byta, de kan hyra nya servrar eller anv√§nda proxy/botn√§t.

3. Domain names
  Angriparens dom√§ner som anv√§nds f√∂r C2 eller phishing.
  Lite sv√•rare och dyrare att ers√§tta √§n IP-adresser, men fortfarande relativt enkelt.

4. Network/Host Artifacts
  T.ex. registernycklar, filer p√• systemet, ovanliga processer.
  Kr√§ver mer arbete f√∂r angriparen att √§ndra eftersom det √§r kopplat till deras verktyg.

5. Tools
  Malware, skript, exploits som angriparen anv√§nder.
  Om du kan uppt√§cka och blockera deras verktyg blir det riktigt jobbigt f√∂r dem ‚Äì de m√•ste utveckla eller skaffa nya.

6. Tactics, Techniques, and Procedures (TTPs)
  Angriparens arbetsmetoder och beteendem√∂nster (hur de r√∂r sig i n√§tverket, hur de sprider sig, hur de stj√§l data).
  Sv√•rast att √§ndra f√∂r angriparen eftersom det bygger p√• deras kunskap, tr√§ning och resurser.
  Ger st√∂rst "pain" om du uppt√§cker och stoppar dem h√§r.

üëâ Po√§ngen: Ju h√∂gre upp i pyramiden du kan f√∂rsvara dig, desto sv√•rare och dyrare blir det f√∂r angriparen att forts√§tta attacken.

TTPs st√•r f√∂r Tactics, Techniques & Procedures.
  Innefattar MITRE ATTACK Matrix som menas alla steg som beh√∂ver tas f√∂r att n√• sitt m√•l, startar med phishing f√∂rs√∂k f√∂r att n√• en startpunkt.





Cyber Kill Chain
  √Ñr en modell som utvecklades av Lockheed Martin och anv√§nds f√∂r att beskriva de olika stegen i en cyberattack. 
  Syftet √§r att f√∂rst√• angriparens metodik och d√§rmed kunna uppt√§cka och stoppa attacker i ett tidigt skede. H√§r √§r en beskrivning av varje steg:

1. Reconnaissance (Spaning)
  I detta inledande steg samlar angriparen information om m√•let. Det kan handla om att kartl√§gga n√§tverk, identifiera s√•rbara system, 
  eller samla in data om anst√§llda genom sociala medier.
  Exempel: Anv√§nda verktyg som Nmap f√∂r portskanning eller OSINT f√∂r att hitta e-postadresser.

2. Weaponization (Bev√§pning)
  H√§r f√∂rbereder angriparen sitt verktyg f√∂r attacken. Vanligtvis kombineras ett exploateringsverktyg med en skadlig nyttolast (payload).
  Exempel: Skapa ett Word-dokument med inb√§ddad makro-malware eller bygga en trojan som kan k√∂ras n√§r offret √∂ppnar filen.

3. Delivery (Leverans)
  Attackverktyget levereras till m√•let. Detta kan ske p√• flera s√§tt ‚Äì via e-post (phishing), USB-enheter, skadliga l√§nkar, eller utnyttjande av os√§kra tj√§nster.
  Exempel: Skicka ett e-postmeddelande med en bifogad infekterad fil.

4. Exploitation (Utnyttjande)
  N√§r m√•let interagerar med den levererade attacken utnyttjas en s√•rbarhet. H√§r f√•r angriparen tillg√•ng till systemet.
  Exempel: Ett klick p√• en l√§nk som aktiverar en s√•rbarhet i webbl√§saren, eller att √∂ppna ett dokument som k√∂r skadlig kod.

5. Installation (Installation)
  Efter att s√•rbarheten utnyttjats installeras skadlig kod, ofta i form av en trojan eller ett bakd√∂rrsprogram, f√∂r att beh√•lla √•tkomst till systemet.
  Exempel: En keylogger eller ett RAT (Remote Access Trojan) installeras p√• den infekterade datorn.

6. Command & Control (C2 / Kommando & Kontroll)
  Angriparen etablerar en kommunikationskanal mellan det infekterade systemet och sin egen server. Detta g√∂r att angriparen kan skicka instruktioner och ta emot data.
  Exempel: Malware kommunicerar med angriparens C2-server via HTTP/HTTPS eller DNS-tunnling.

7. Actions on Objectives (Genomf√∂rande av m√•l)
  Slutligen utf√∂r angriparen sina m√•l. Detta kan vara datast√∂ld, spionage, sabotage, kryptering av filer (ransomware) eller att sprida sig vidare i n√§tverket.
  Exempel: Exfiltrering av k√§nsliga filer, kryptering av databaser, eller att sabotera produktion.

üëâ Po√§ngen med Cyber Kill Chain 
  √Ñr att en f√∂rsvarare inte n√∂dv√§ndigtvis m√•ste stoppa angriparen i alla steg ‚Äì det r√§cker att uppt√§cka och blockera attacken i ett av stegen f√∂r att f√∂rhindra att m√•let uppn√•s.






Unified Kill Chain
  Den Unified Kill Chain √§r ett koncept inom cybers√§kerhet som anv√§nds f√∂r att beskriva och analysera hur cyberattacker genomf√∂rs steg f√∂r steg. 
  Det √§r en vidareutveckling och sammanslagning av olika ‚Äúkill chain‚Äù-modeller, 
  s√•som Lockheed Martins kill chain och MITRE ATT&CK-ramverket, f√∂r att ge en mer komplett bild av en attack.

  Vad √§r en kill chain?
    En kill chain beskriver de olika steg en angripare tar f√∂r att lyckas med en attack. Genom att f√∂rst√• dessa steg kan f√∂rsvarare identifiera var de kan stoppa attacken.

  Unified Kill Chain
    Syfte: Att skapa en mer holistisk modell som t√§cker alla faser av en attack ‚Äì fr√•n initial rekognosering till efterattack-aktiviteter.
    F√∂rdel: Ger ett gemensamt spr√•k och struktur f√∂r b√•de detektion och respons.
    Inneh√•ll: Kombinerar ofta steg fr√•n olika modeller (Lockheed Martin, MITRE ATT&CK) till en enhetlig kedja.

  Varf√∂r √§r Unified Kill Chain viktig?
    Hj√§lper s√§kerhetsteam att f√∂rst√• attacker som helhet.
    G√∂r det l√§ttare att planera f√∂rebyggande √•tg√§rder.
    Integrerar olika ramverk f√∂r mer effektiv detektion och respons.


Threat modelling
 √Ñr en metod f√∂r att identifiera, f√∂rst√• och hantera m√∂jliga hot mot ett system. H√§r √§r en detaljerad f√∂rklaring:

  Definition
    Threat modeling √§r processen d√§r man systematiskt analyserar ett system f√∂r att uppt√§cka potentiella s√§kerhetshot, s√•rbarheter och angripares m√∂jliga angreppsmetoder. 
    M√•let √§r att designa systemet s√• att riskerna minimeras.

  Grundl√§ggande steg i threat modeling
    1. Identifiera tillg√•ngar (Assets)
      - Vilka data, system eller resurser √§r v√§rdefulla?
    
    2. Skapa en arkitektur√∂versikt (Architecture Overview)
      - Rita upp systemets komponenter, datalagring, kommunikationsfl√∂den etc.
    
    3. Identifiera hot (Threat Identification)
      - Anv√§nd ramverk som STRIDE (Spoofing, Tampering, Repudiation, Information disclosure, Denial of service, Elevation of privilege) f√∂r att lista m√∂jliga attacker.
    
    4. Identifiera s√•rbarheter (Vulnerability Analysis)
      - Se vilka delar av systemet som √§r svaga eller kan utnyttjas.
    
    5. Prioritera risker (Risk Prioritization)
      - Bed√∂m sannolikhet och p√•verkan av olika hot f√∂r att fokusera p√• de viktigaste.
    
    6. F√∂resl√• mot√•tg√§rder (Mitigation)
      - Designa s√§kerhets√•tg√§rder som minskar eller eliminerar hoten.


  Varf√∂r threat modeling √§r viktigt
    - G√∂r s√§kerhet proaktiv ist√§llet f√∂r reaktiv.
    - Hj√§lper utvecklare att bygga s√§krare system fr√•n b√∂rjan.
    - Integreras ofta i DevSecOps och s√§ker mjukvaruutveckling.




Diamond Model
  √Ñr en analysmodell inom cyber security som anv√§nds f√∂r att strukturera och f√∂rst√• cyberattacker. 
  Den introducerades av Caltagirone, Pendergast och Betz 2013 och anv√§nds ofta inom threat intelligence och incidentanalys.

  Id√©n √§r att varje intr√•ng eller h√§ndelse kan beskrivas genom fyra centrala element i en diamantformad modell:
    1. Adversary ‚Äì angriparen eller gruppen bakom attacken. Attackerare kallas Adversary Operator.
    2. Capability ‚Äì de verktyg, metoder och tekniker som angriparen anv√§nder.
    3. Infrastructure ‚Äì den infrastruktur som m√∂jligg√∂r attacken, till exempel servrar, dom√§ner, n√§tverk eller malware-distribution.
    4. Victim ‚Äì den organisation, individ eller system som attacken riktas mot. Kallas Victim Personae
üìå Mitten av diamanten representerar ‚ÄùEvent‚Äù, allts√• sj√§lva h√§ndelsen som kopplar samman alla fyra h√∂rn.

Exempel
  - Adversary: En APT-grupp fr√•n en viss region.
  - Capability: En zero-day exploit och ett RAT (Remote Access Trojan).
  - Infrastructure: Command & Control-servrar, phishing-dom√§ner.
  - Victim: Ett f√∂retag i finanssektorn.

Syfte
  - Ge en systematisk analys av attacker.
  - Hj√§lpa att identifiera m√∂nster och samband mellan olika attacker.
  - Underl√§tta threat hunting och attribution (vem ligger bakom attacken).
  - St√∂tta utvecklingen av defensiva √•tg√§rder.

Diamond-modellen kan kompletteras med sex valfria meta-features som ger extra kontext och underr√§ttelsev√§rde f√∂r varje h√§ndelse:
  1. Timestamp ‚Äì datum/tid f√∂r h√§ndelsen (start/stop). Viktigt f√∂r att hitta tidsm√∂nster och indikera tidzoner eller arbetstider.
  2. Phase ‚Äì vilken fas i attackkedjan h√§ndelsen tillh√∂r (t.ex. Reconnaissance, Weaponization, Delivery, Exploitation, Installation, Command & Control, Actions on Objective). 
      Visar att attacker ofta √§r flera f√∂ljdskeden.
  3. Result ‚Äì utfall eller efter-tillst√•nd (t.ex. success, failure, unknown) och koppling till CIA-triaden 
      (konfidentialitet, integritet, tillg√§nglighet) eller konkreta f√∂ljder (t.ex. exfiltration av l√∂senord).
  4. Direction ‚Äì riktningen f√∂r aktiviteten mellan parter (t.ex. Victim‚ÜíInfrastructure, Infrastructure‚ÜíVictim, Adversary‚ÜíInfrastructure, 
      Bidirectional, Unknown). Hj√§lper s√§rskilja host- vs n√§tverksh√§ndelser.
  5. Methodology ‚Äì generell klassificering av intr√•nget (t.ex. phishing, DDoS, breach, port scan).
  6. Resources ‚Äì externa resurser som m√∂jliggjorde attacken (mjukvara, kunskap, information, h√•rdvara, pengar, anl√§ggningar, n√§taccess etc.).

Kort sagt: meta-features √§r inte obligatoriska, men de ger viktigt tids-, fas-, riktnings-, utfalls- och resurs-kontext som f√∂rb√§ttrar analys, korrelation och f√∂rst√•else av intr√•ng.







üîπMITRE Corporation
  Det √§r en amerikansk icke-vinstdrivande organisation som arbetar med forskning och utveckling f√∂r bland annat f√∂rsvar, flyg, sjukv√•rd och cybers√§kerhet.

üîπ MITRE ATT&CK
  Inom cybers√§kerhet √§r MITRE mest k√§nt f√∂r ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge).
  Det √§r en globalt tillg√§nglig kunskapsbas som beskriver angripares beteenden, allts√• vilka taktiker, tekniker och procedurer TTPs (Tactics, Techniques, and Procedures)  
  de anv√§nder i verkliga attacker.

  Ramverket anv√§nds av:
    üëâSOC-analytiker ‚Üí f√∂r att f√∂rst√• och uppt√§cka attacker.
    üëâRed team & blue team ‚Üí f√∂r att simulera attacker respektive f√∂rsvara sig mot dem.
    üëâThreat intelligence ‚Üí f√∂r att kartl√§gga och analysera hotakt√∂rer.
    üëâS√§kerhetsl√∂sningar ‚Üí f√∂r att m√§ta t√§ckning och effektivitet av detektionssystem.

  üìå Exempel:
    Om en angripare f√∂rs√∂ker f√• tag p√• administrat√∂rsr√§ttigheter kan deras metod beskrivas i MITRE ATT&CK under tekniken ‚ÄúPrivilege Escalation‚Äù.

üëâ S√• n√§r man pratar om MITRE inom cybers√§kerhet menar man n√§stan alltid MITRE ATT&CK-ramverket, som √§r ett centralt verktyg f√∂r att f√∂rst√•, analysera och f√∂rsvara mot cyberattacker.




MITRE CAR (Cyber Analytics Repository)
  Vad det √§r:
    üîπMITRE CAR √§r en samling av analysrecept (‚Äùanalytics‚Äù) som beskriver hur man kan uppt√§cka angripares beteenden i loggar och telemetri, ofta kopplade direkt till MITRE ATT&CK-tekniker.
  Syfte:
    üîπMedan ATT&CK beskriver vad angriparna g√∂r, s√• beskriver CAR hur man kan uppt√§cka det i praktiken. Det fungerar som en brygga mellan teori och verklig SOC/blue team-analys.

  Exempel:
    üîπATT&CK s√§ger att angripare kan anv√§nda PowerShell f√∂r att exekvera kod (T1059.001).
    üîπCAR kan d√• ha en analys som: ‚ÄúLeta efter ovanliga PowerShell-kommandon i processloggar, s√§rskilt de som inneh√•ller Base64-kodning.‚Äù

  Anv√§ndningsomr√•den:
    üîπSOC-analytiker kan anv√§nda CAR som mallar f√∂r att skapa detektionsregler i SIEM/XDR.
    üîπS√§kerhetsteam kan kartl√§gga sina gap i detektion.
    üîπGer en praktisk koppling mellan hotintelligens och loggdata.

üëâ Man kan allts√• s√§ga:
  üîπMITRE ATT&CK = angriparens karta (vad de g√∂r)
  üîπMITRE CAR = analytikerns verktygsl√•da (hur man hittar det i loggarna)



MITRE ENGAGE
  Vad det √§r:
    üîπMITRE ENGAGE √§r ett ramverk f√∂r aktiva f√∂rsvarsstrategier och mot√•tg√§rder mot cyberangripare.
      Det √§r i praktiken en guide f√∂r deception, st√∂rning och f√∂rdr√∂jning av angripare n√§r de v√§l √§r inne i systemet.
  Syfte:
    Till skillnad fr√•n ATT&CK (som beskriver angriparnas beteenden) och CAR (som beskriver hur man uppt√§cker dem), s√• handlar ENGAGE om:
      üîπHur man kan agera aktivt f√∂r att f√∂rsv√•ra f√∂r angripare.
      üîπHur man lurar eller vilseleder angripare (exempelvis med honeypots, falska filer, vilseledande konton).
      üîπHur man samlar in information om angriparen under p√•g√•ende intr√•ng.

  Exempel p√• tekniker inom ENGAGE:
  üîπPlacera ut decoy credentials (falska l√∂senord eller konton) som avsl√∂jar angriparen n√§r de anv√§nds.
  üîπBygga honeynets/honeypots f√∂r att attrahera angripare.
  üîπAnv√§nda falska systemkonfigurationer f√∂r att sl√∂sa angriparens tid.
  üîπAktivt manipulera angriparens uppfattning om n√§tverket.

  J√§mf√∂relse:
  üîπATT&CK ‚Üí Vad angripare g√∂r.
  üîπCAR ‚Üí Hur vi kan uppt√§cka dem.
  üîπENGAGE ‚Üí Hur vi kan aktivt st√∂ra, lura eller p√•verka angriparna.

üìå Det √§r allts√• ett ramverk f√∂r defense-in-depth med fokus p√• deception och proaktivt f√∂rsvar ‚Äì n√•got som anv√§nds i avancerade SOC-milj√∂er och milit√§r cybers√§kerhet.




MITRE D3FEND
  √Ñr ett systerramverk till ATT&CK, men ist√§llet f√∂r att beskriva angriparens beteenden s√• beskriver det f√∂rsvarstekniker.
  Vad det √§r:
    üîπD3FEND √§r en taxonomi √∂ver cyberf√∂rsvarstekniker.
    üîπBygger p√• samma struktur som ATT&CK (taktiker ‚Üí tekniker).
    üîπKopplar angreppstekniker (ATT&CK) till f√∂rsvarsmekanismer (D3FEND).

  Syfte:
    üîπHj√§lpa s√§kerhetsteam att f√∂rst√• vilka defensiva √•tg√§rder som motverkar specifika attacker.
    üîπGe en gemensam terminologi f√∂r f√∂rsvar, precis som ATT&CK ger f√∂r attacker.
    üîπSt√∂dja SOC, red/blue/purple teaming och arkitekter i att designa robusta f√∂rsvar.

  Exempel:
    üîπATT&CK: Angriparen anv√§nder Credential Dumping (T1003) f√∂r att komma √•t l√∂senord.
    üîπD3FEND: F√∂resl√•r f√∂rsvarstekniker som Credential Hardening, Credential Monitoring eller Process Isolation.

  Hur det h√§nger ihop med de andra:
    üîπATT&CK ‚Üí kartl√§gger angriparnas angreppstekniker.
    üîπCAR ‚Üí visar hur vi kan uppt√§cka dessa i loggar och analys.
    üîπENGAGE ‚Üí ger aktiva f√∂rsvarsstrategier f√∂r att st√∂ra angriparen.
    üîπD3FEND ‚Üí definierar vilka f√∂rsvarstekniker som stoppar eller f√∂rsv√•rar ATT&CK-teknikerna.

üëâ Man kan allts√• s√§ga att:
  üîπATT&CK √§r angriparens lexikon.
  üîπD3FEND √§r f√∂rsvararens lexikon.
  üîπCAR √§r detektorns manual.
  üîπENGAGE √§r stridsplanen f√∂r att f√∂rvirra fienden.




Cyber Threat Intel
  
  CTI = (Cyber Threat Intelligence)
  IOC = (Indicator of Compromise)
  IOA = (Indicator of Attack)
  TTP = (Tactics, Techniques, and Procedures)

Threat intelligence handlar om att f√∂rst√• relationen mellan organisationens operativa milj√∂ och dess motst√•ndare. Det kan delas in i f√∂ljande kategorier:
  üîπStrategisk intel: 
      √ñvergripande analys av hotlandskapet, trender och m√∂nster som kan p√•verka aff√§rsbeslut. Exempel: en √•rlig rapport om ransomware som f√∂rutsp√•r nya angreppsmetoder.
  üîπTaktisk intel: 
      Bed√∂mning av angripares beteenden genom analys av TTP:er (taktiker, tekniker och procedurer). Exempel: varningsnotiser om nya s√§tt att missbruka Visual Basic i malspam.
  üîπOperationell intel: 
      Information om specifika kampanjer, angriparens motiv och intentioner. Hj√§lper till att identifiera vilka tillg√•ngar (personer, processer, teknologier) som kan vara m√•ltavlor.
  üîπTeknisk intel: 
      Konkreta indikatorer och artefakter, t.ex. IP-adresser eller filhashar som anv√§nds i attacker.


Cyber Threat Intelligence (CTI) ‚Äì Livscykel i sex steg
  CTI omvandlar r√•data till kontextualiserade och handlingsbara insikter f√∂r att hantera s√§kerhetsincidenter. 
  I exemplet f√∂ljer vi SOC-analytikern Alex, som har i uppdrag att skydda TryHatMe:s produktionsdatabas.

  1. Riktning (Direction)
      Tillsammans med ledning och tekniker definieras uppdraget: skydda PostgreSQL-databasen mot dataintr√•ng och malware. 
      Tv√• fr√•gor styr arbetet: vilka IP/dom√§ner attackerar PostgreSQL och vilka malwarefamiljer √§r aktiva mot databasen?

  2. Insamling (Collection)
      Alex h√§mtar data fr√•n kommersiella fl√∂den, √∂ppna k√§llor (t.ex. AbuseIPDB), interna plattformar (MISP) och leverant√∂rsrapporter. All data lagras strukturerat i STIX/CSV-format.

  3. Bearbetning (Processing)
      R√•data normaliseras och korreleras f√∂r att undvika dubbletter och mots√§gelser. Indikatorerna m√§rks med k√§lla, datum och TLP-niv√•. 
      Resultatet omvandlas till praktiska filer: en blocklista f√∂r brandv√§ggen och YARA-regler f√∂r EDR.

  4. Analys (Analysis)
      Indikatorer granskas f√∂r relevans och prioriteras efter k√§llor och lokala observationer. Exempel: vissa IP:n har f√∂rs√∂kt n√• databasen, ett hashv√§rde kopplas till malware som angriper f√∂retagets drivrutiner. 
      Indikatorerna graderas i h√∂g, medel eller l√•g tillf√∂rlitlighet.

  5. Spridning (Dissemination)
      Informationen delas m√•lgruppsanpassat: brandv√§ggsteamet f√•r en CSV, endpoint-teamet YARA-regler, CTI-plattformen fullst√§ndiga objekt, och ledningen en kort rapport.

  6. √Öterkoppling (Feedback)
      Tv√• veckor senare visar m√§tningar att attackf√∂rs√∂k blockeras direkt (fr√•n 48 h ned till 0 h) och inga falska positiva rapporter f√∂rekommer. 
      Processen anses framg√•ngsrik och ut√∂kas till fler hotparametrar.

√ñvriga nyckelbegrepp
  - Traffic Light Protocol (TLP): reglerar hur hotinformation f√•r delas (Clear, Green, Amber, Red).
  - Format: STIX anv√§nds f√∂r att standardisera hotdata.



CVEs, CVSS och NVD
  üëâCVE (Common Vulnerabilities and Exposures) ‚Äî tilldelar ett katalognummer f√∂r uppt√§ckta s√•rbarheter, t.ex. CVE-2023-4863.
  üëâCVSS (Common Vulnerability Scoring System) ‚Äî en allvarlighetsskala fr√•n 0‚Äì10 med tidsm√§ssiga och milj√∂m√§ssiga modifierare f√∂r s√•rbarheter.
  üëâNVD (National Vulnerability Database) ‚Äî den officiella databasen som kopplar CVE-nummer till CVSS-po√§ng, exploits och ber√∂rda produkter.

Sharing and Processing Intel
  üîπEn SOC-analytiker m√•ste f√∂rst√• hantering av s√•rbarheter.
  üîπCVE ger ett unikt ID f√∂r varje s√•rbarhet.
  üîπCVSS bed√∂mer allvarlighetsgraden p√• en skala 0‚Äì10.
  üîπNVD √§r den officiella databasen som kopplar CVE:er till CVSS-po√§ng, exploits och ber√∂rda produkter.











